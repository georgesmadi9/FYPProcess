<form role="form">

    <script cam-script type="text/form-script">
        camForm.on('form-loaded', function() {
            $scope.contextPath = camForm.formUrl.split("/forms/")[0];
            $scope.taskId = camForm.taskId;
        });
        camForm.on('form-loaded', function() {
        // tell the form SDK to fetch the variable named 'customer'
        camForm.variableManager.fetchVariable('AVAILABLE_PROJECTS');

      });
      camForm.on('variables-fetched', function() {
        // work with the variable (bind it to the current AngularJS $scope)
        var projSTR = camForm.variableManager.variableValue('AVAILABLE_PROJECTS');
        // transform the strings array into JSON
        var i = 0;
        var l = projSTR.length;
        var projs = [];
        while (i < l) {
            var jsonobj = JSON.parse(projSTR[i]);
            projs.push(jsonobj);
            i++;
        }
        $scope.projects = [...projs];
      });
    </script>

     <div class="container-fluid">
         <table class="table table-striped">
             <tr>
                 <td>Project Name</td>
                 <td>Supervisor</td>
                 <td>Number of members per team</td>
                 <td></td>
             </tr>
             <tr ng-repeat="proj in projects">
                 <td>{{proj.projectname}}</td>
                 <td>{{proj.advisor}}</td>
                 <td>{{proj.studentsnumber}}</td>
                 <td>
                     <a href="{{contextPath}}/file-variable?taskId={{taskId}}&variableName=document" class="btn btn-primary">Download PDF</a>                 </td>
             </tr>
         </table>

     </div>

</form>
